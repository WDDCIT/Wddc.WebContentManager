@{
    ViewBag.Title = "Website Insider Newsletter";
}

@section Styles {
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://kendo.cdn.telerik.com/2021.2.511/styles/kendo.default.min.css" rel="stylesheet" />
    <link href="https://kendo.cdn.telerik.com/2021.2.511/styles/kendo.bootstrap-v4.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
}

@section Scripts {
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.0/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2021.2.511/js/kendo.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="~/js/pagination/pagination.min.js"></script>
    <script src="~/js/pagination/pagination.custom.js"></script>

    <script>
        $(document).ready(function () {
            prepareLogList();

            // Handle alerts
            var alertType = '@TempData["AlertType"]';
            var alertMessage = '@TempData["AlertMessage"]';

            if (alertType && alertMessage) {
                if (alertType === "Success") {
                    showAlert('success', alertMessage);
                } else {
                    showAlert('error', alertMessage);
                }
            }

            // File input handlers
            $("#newInfoFileUrl").on("change", function (e) {
                var fileName = $(this).val().split("\\").pop();
                $("#newInfoFileUrlText").val(fileName);
            });

            $("#updatedInfoFileUrl").on("change", function (e) {
                var fileName = $(this).val().split("\\").pop();
                $("#updatedInfoFileUrlText").val(fileName);
            });

            // Initialize Kendo components
            $("#newsletterToUpdate").kendoDropDownList({
                filter: "contains",
                valueTemplate: '<span class="k-state-default"><p>#: kendo.toString(new Date(data.IssueDate), "MMMM dd,yyyy") #</p></span>&nbsp;&nbsp;&nbsp;&nbsp;' +
                               '<span class="k-state-default"><p>#: data.Description #</p></span>',
                template: '<span class="k-state-default"><p>#: kendo.toString(new Date(data.IssueDate), "MMMM dd,yyyy") #</p></span>&nbsp;&nbsp;&nbsp;&nbsp;' +
                          '<span class="k-state-default"><p>#: data.Description #</p></span>',
                footerTemplate: 'Total #: instance.dataSource.total() # items found',
                dataTextField: "Description",
                dataValueField: "ID",
                height: 300,
                dataSource: {
                    transport: {
                        read: {
                            url: '@Url.Action("GetWebInsiderNews", "InsiderNewsletter")',
                            dataType: "json"
                        }
                    }
                },
                open: function(e) {
                    $("#update-form-row").hide();
                },
                filtering: function (ev) {
                    var filterValue = ev.filter != undefined ? ev.filter.value : "";
                    ev.preventDefault();
                    this.dataSource.filter({
                        logic: "or",
                        filters: [
                            { field: "IssueDate", operator: "contains", value: filterValue },
                            { field: "Description", operator: "contains", value: filterValue }
                        ]
                    });
                }
            });

            $("#newsletterToDelete").kendoDropDownList({
                filter: "contains",
                valueTemplate: '<span class="k-state-default"><p>#: kendo.toString(new Date(data.IssueDate), "MMMM dd,yyyy") #</p></span>&nbsp;&nbsp;&nbsp;&nbsp;' +
                               '<span class="k-state-default"><p>#: data.Description #</p></span>',
                template: '<span class="k-state-default"><p>#: kendo.toString(new Date(data.IssueDate), "MMMM dd,yyyy") #</p></span>&nbsp;&nbsp;&nbsp;&nbsp;' +
                          '<span class="k-state-default"><p>#: data.Description #</p></span>',
                footerTemplate: 'Total #: instance.dataSource.total() # items found',
                dataTextField: "Description",
                dataValueField: "ID",
                height: 300,
                dataSource: {
                    transport: {
                        read: {
                            url: '@Url.Action("GetWebInsiderNews", "InsiderNewsletter")',
                            dataType: "json"
                        }
                    }
                },
                open: function(e) {
                    $("#delete-form-row").hide();
                },
                filtering: function (ev) {
                    var filterValue = ev.filter != undefined ? ev.filter.value : "";
                    ev.preventDefault();
                    this.dataSource.filter({
                        logic: "or",
                        filters: [
                            { field: "IssueDate", operator: "contains", value: filterValue },
                            { field: "Description", operator: "contains", value: filterValue }
                        ]
                    });
                }
            });

            // Date pickers
            $("#newIssueDate").kendoDatePicker({
                format: "MMMM dd, yyyy",
                value: new Date()
            });

            $("#updatedIssueDate").kendoDatePicker({
                format: "MMMM dd, yyyy"
            });

            $("#deletedIssueDate").kendoDatePicker({
                format: "MMMM dd, yyyy"
            });

            // Collapsible functionality
            $('.collapsible-btn').on('click', function() {
                const $btn = $(this);
                const $content = $btn.next('.collapsible-content');
                const wasOpen = $btn.hasClass('active');

                // Close all other sections
                $('.collapsible-btn.active').not($btn).each(function() {
                    $(this).removeClass('active');
                    $(this).next('.collapsible-content').css('maxHeight', '0px');
                });

                // Toggle clicked section
                if (wasOpen) {
                    $btn.removeClass('active');
                    $content.css('maxHeight', '0px');
                } else {
                    $btn.addClass('active');
                    $content.css('maxHeight', $content[0].scrollHeight + 'px');
                    $content.one('transitionend', function() {
                        if ($content.css('maxHeight') !== '0px') {
                            $content.css('maxHeight', '10000px');
                        }
                    });
                }
            });
        });

        function showAlert(type, message) {
            if (type === 'success') {
                Swal.fire({
                    icon: 'success',
                    title: 'Success!',
                    text: message,
                    showConfirmButton: false,
                    timer: 3000,
                    position: 'center',
                    timerProgressBar: true
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Error!',
                    text: message,
                    confirmButtonColor: '#1a73e8',
                    confirmButtonText: 'OK'
                });
            }
        }

        function selectNewsletterToUpdate() {
            let newsletterToUpdateId = $("#newsletterToUpdate").val().trim();

            $.getJSON('@Url.Action("GetWebInsiderNewsById", "InsiderNewsletter")?ID=' + newsletterToUpdateId, function(result) {
                $("#updatedNewsletterId").val(result.ID);
                $("#updatedDescription").val(result.Description);
                $("#updatedIssueDate").data("kendoDatePicker").value(new Date(result.IssueDate));

                if (result.Status == 1)
                    $("#updatedStatusYes").prop("checked", true);
                else
                    $("#updatedStatusNo").prop("checked", true);

                $("#toUpdateInsiderLogo").attr("src", "../Newsletter_Logos/INSIDER/" + result.IssueNumber + ".jpg");
                $("#toUpdateInsiderPdf").attr("href", "https://www.wddc.com/wddc_members/CS/Newsletter/Insider/" + result.IssueNumber + ".pdf");

                $("#update-form-row").slideDown(400);
            });
        }

        function selectNewsletterToDelete() {
            let newsletterToDeleteId = $("#newsletterToDelete").val().trim();

            $.getJSON('@Url.Action("GetWebInsiderNewsById", "InsiderNewsletter")?ID=' + newsletterToDeleteId, function(result) {
                $("#deletedNewsletterId").val(result.ID);
                $("#deletedDescription").val(result.Description);
                $("#deletedIssueDate").data("kendoDatePicker").value(new Date(result.IssueDate));
                $("#deletedIssueDate").data("kendoDatePicker").enable(false);

                if (result.Status == 1)
                    $("#deletedStatusYes").prop("checked", true);
                else
                    $("#deletedStatusNo").prop("checked", true);

                $("#toDeleteInsiderLogo").attr("src", "../Newsletter_Logos/INSIDER/" + result.IssueNumber + ".jpg");
                $("#toDeleteInsiderPdf").attr("href", "https://www.wddc.com/wddc_members/CS/Newsletter/Insider/" + result.IssueNumber + ".pdf");

                $("#delete-form-row").slideDown(400);
            });
        }

        function validateAddForm() {
            var newDescription = $("#newDescription").val().trim();
            if (!newDescription) {
                Swal.fire({ icon: 'warning', title: 'Missing Information', text: 'Please enter a description', confirmButtonColor: '#1a73e8' });
                return false;
            }

            var newInfoFileUrl = $("#newInfoFileUrl").val();
            if (!newInfoFileUrl) {
                Swal.fire({ icon: 'warning', title: 'Missing File', text: 'Please select a PDF file', confirmButtonColor: '#1a73e8' });
                return false;
            }

            var newIssueDate = $("#newIssueDate").val().trim();
            if (!newIssueDate) {
                Swal.fire({ icon: 'warning', title: 'Missing Date', text: 'Please select an issue date', confirmButtonColor: '#1a73e8' });
                return false;
            }

            // Show confirmation dialog
            event.preventDefault();
            Swal.fire({
                title: 'Confirm Add Newsletter',
                html: `Are you sure you want to add this newsletter?<br><br><strong>${newDescription}</strong><br>${newIssueDate}`,
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#1a73e8',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'Yes, Add It',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    document.getElementById('add-form').submit();
                }
            });

            return false;
        }

        function validateUpdateForm() {
            var updatedDescription = $("#updatedDescription").val().trim();
            if (!updatedDescription) {
                Swal.fire({ icon: 'warning', title: 'Missing Information', text: 'Please enter a description', confirmButtonColor: '#1a73e8' });
                return false;
            }

            var updatedIssueDate = $("#updatedIssueDate").val().trim();
            if (!updatedIssueDate) {
                Swal.fire({ icon: 'warning', title: 'Missing Date', text: 'Please select an issue date', confirmButtonColor: '#1a73e8' });
                return false;
            }

            // Show confirmation dialog
            event.preventDefault();
            Swal.fire({
                title: 'Confirm Update Newsletter',
                html: `Are you sure you want to update this newsletter?<br><br><strong>${updatedDescription}</strong><br>${updatedIssueDate}`,
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#1a73e8',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'Yes, Update It',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    document.getElementById('update-form').submit();
                }
            });

            return false;
        }

        function confirmDeleteNewsletter() {
            event.preventDefault();

            var deletedDescription = $("#deletedDescription").val().trim();
            var deletedIssueDate = $("#deletedIssueDate").val().trim();

            Swal.fire({
                title: 'Confirm Delete Newsletter',
                html: `Are you sure you want to <strong>permanently delete</strong> this newsletter?<br><br><strong>${deletedDescription}</strong><br>${deletedIssueDate}<br><br>This action cannot be undone!`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#dc3545',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'Yes, Delete It',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    document.getElementById('delete-form').submit();
                }
            });

            return false;
        }

        function prepareLogList() {
            setupPagination('log', 'log-list', '@Url.Action("Log", "InsiderNewsletter")?referrerUrl=InsiderNewsletter', ['Log', 'Username', 'Created'], 7);
        }

        function toggleLog() {
            $('#log-section').toggleClass('hidden');
            const isHidden = $('#log-section').hasClass('hidden');
            $('#toggle-log-btn').html(`<i class="fa fa-${isHidden ? 'eye' : 'eye-slash'}"></i> ${isHidden ? 'Show' : 'Hide'} Log`);
        }
    </script>
}

<div class="modern-wrapper">
    <!-- Header Section -->
    <div class="page-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-12">
                    <h2 class="page-title">
                        <i class="fa fa-newspaper"></i> Insider Newsletter Management
                    </h2>
                    <p class="page-subtitle">
                        Add, edit, and delete weekly Insider newsletters
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid">
        <!-- Add Newsletter Section -->
        <div class="action-card mb-4">
            <button type="button" class="collapsible-btn">
                <i class="fa fa-plus-circle"></i>
                <span>Add Insider Newsletter</span>
                <i class="fa fa-chevron-down float-end toggle-icon"></i>
            </button>
            <div class="collapsible-content">
                <form id="add-form" name="add-form" method="post"
                      action="@Url.Action("AddWebsiteNewsletter", "InsiderNewsletter")"
                      enctype="multipart/form-data" onsubmit="return validateAddForm()">
                    <div class="row justify-content-center">
                        <div class="col-lg-2"></div>
                        <div class="col-lg-8">
                            <div class="form-group-modern form-group-large form-group-inline">
                                <label for="newDescription" class="form-label-modern form-label-large form-label-inline">
                                    <i class="fa fa-align-left"></i> Description: <span class="text-danger">*</span>
                                </label>
                                <div class="form-input-inline">
                                    <input id="newDescription" name="newDescription" class="form-control-modern form-control-large"
                                           type="text" maxlength="69" placeholder="Enter newsletter description" required />
                                </div>
                            </div>

                            <div class="form-group-modern form-group-large form-group-inline">
                                <label for="newInfoFileUrlText" class="form-label-modern form-label-large form-label-inline">
                                    <i class="fa fa-file-pdf"></i> PDF File: <span class="text-danger">*</span>
                                </label>
                                <div class="form-input-inline">
                                    <div class="file-upload-wrapper">
                                        <input id="newInfoFileUrlText" name="newInfoFileUrlText" class="form-control form-control-large"
                                               type="text" readonly placeholder="No file selected" />
                                        <input id="newInfoFileUrl" name="newInfoFileUrl" type="file" accept=".pdf" style="display:none" required />
                                        <button type="button" class="btn btn-light" onclick="$('#newInfoFileUrl').click()">
                                            <i class="fa fa-cloud-upload-alt"></i> Browse
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group-modern form-group-large form-group-inline">
                                <label for="newIssueDate" class="form-label-modern form-label-large form-label-inline">
                                    <i class="fa fa-calendar-alt"></i> Issue Date: <span class="text-danger">*</span>
                                </label>
                                <div class="form-input-inline" style="display: flex; justify-content: flex-start;">
                                    <input id="newIssueDate" name="newIssueDate" class="form-control-modern" style="width: 50%" />
                                </div>
                            </div>

                            <div class="form-group-modern form-group-large form-group-inline">
                                <label for="newStatus" class="form-label-modern form-label-large form-label-inline">
                                    <i class="fa fa-eye"></i> Visibility:
                                </label>
                                <div class="form-input-inline">
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" id="newStatusYes" name="newStatus" value="yes" checked />
                                            <span class="radio-custom"></span>
                                            <span>Visible</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" id="newStatusNo" name="newStatus" value="no" />
                                            <span class="radio-custom"></span>
                                            <span>Hidden</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2"></div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-modern btn-md">
                            <i class="fa fa-plus"></i> Add Newsletter
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Update Newsletter Section -->
        <div class="action-card mb-4">
            <button type="button" class="collapsible-btn">
                <i class="fa fa-edit"></i>
                <span>Update Insider Newsletter</span>
                <i class="fa fa-chevron-down float-end toggle-icon"></i>
            </button>
            <div class="collapsible-content">
                <div class="search-section">
                    <div class="row justify-content-center">
                        <div class="col-lg-2"></div>
                        <div class="col-lg-8">
                            <div class="form-group-modern">
                                <label class="form-label-modern">
                                    <i class="fa fa-search"></i> Search Newsletter to Update
                                </label>
                                <input id="newsletterToUpdate" class="form-control-modern" />
                            </div>
                            <div class="text-center mt-3">
                                <button type="button" class="btn btn-primary btn-modern" onclick="selectNewsletterToUpdate()">
                                    <i class="fa fa-check"></i> Select
                                </button>
                            </div>
                        </div>
                        <div class="col-lg-2"></div>
                    </div>
                </div>

                <div id="update-form-row" style="display:none;" class="mt-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-2"></div>
                        <div class="col-lg-8">
                            <div class="update-form-container">
                                <h5 class="section-title">
                                    <i class="fa fa-edit"></i> Update Selected Newsletter
                                </h5>

                                <div class="preview-section mb-4">
                                    <p class="preview-label">Current Newsletter Preview</p>
                                    <a href="#" id="toUpdateInsiderPdf" target="_blank" class="preview-link">
                                        <img id="toUpdateInsiderLogo" class="preview-image" alt="Newsletter Preview" />
                                        <div class="preview-overlay">
                                            <i class="fa fa-external-link-alt"></i>
                                        </div>
                                    </a>
                                </div>

                                <form id="update-form" name="update-form" method="post"
                                      action="@Url.Action("UpdateWebsiteNewsletter", "InsiderNewsletter")"
                                      enctype="multipart/form-data" onsubmit="return validateUpdateForm()">
                                    <input type="hidden" id="updatedNewsletterId" name="updatedNewsletterId" />

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="updatedDescription" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-align-left"></i> Description:
                                        </label>
                                        <div class="form-input-inline">
                                            <input id="updatedDescription" name="updatedDescription" class="form-control-modern form-control-large"
                                                   type="text" maxlength="69" />
                                        </div>
                                    </div>

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="updatedInfoFileUrlText" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-file-pdf"></i> PDF File:
                                        </label>
                                        <div class="form-input-inline">
                                            <div class="file-upload-wrapper">
                                                <input id="updatedInfoFileUrlText" name="updatedInfoFileUrlText" class="form-control form-control-large"
                                                       type="text" readonly placeholder="Leave empty to keep current PDF" />
                                                <input id="updatedInfoFileUrl" name="updatedInfoFileUrl" type="file" accept=".pdf" style="display:none" />
                                                <button type="button" class="btn btn-light" onclick="$('#updatedInfoFileUrl').click()">
                                                    <i class="fa fa-cloud-upload-alt"></i> Browse
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="updatedIssueDate" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-calendar-alt"></i> Issue Date:
                                        </label>
                                        <div class="form-input-inline">
                                            <input id="updatedIssueDate" name="updatedIssueDate" class="form-control-modern" style="width: 50%" />
                                        </div>
                                    </div>

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="updatedStatus" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-eye"></i> Visibility:
                                        </label>
                                        <div class="form-input-inline">
                                            <div class="radio-group">
                                                <label class="radio-label">
                                                    <input type="radio" id="updatedStatusYes" name="updatedStatus" value="yes" checked />
                                                    <span class="radio-custom"></span>
                                                    <span>Visible</span>
                                                </label>
                                                <label class="radio-label">
                                                    <input type="radio" id="updatedStatusNo" name="updatedStatus" value="no" />
                                                    <span class="radio-custom"></span>
                                                    <span>Hidden</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-primary btn-modern btn-md">
                                            <i class="fa fa-save"></i> Update Newsletter
                                        </button>
                                        <button type="button" class="btn btn-secondary btn-modern btn-md" onclick="$('#update-form-row').slideUp(400)">
                                            <i class="fa fa-times"></i> Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-lg-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Newsletter Section -->
        <div class="action-card mb-4">
            <button type="button" class="collapsible-btn">
                <i class="fa fa-trash"></i>
                <span>Delete Insider Newsletter</span>
                <i class="fa fa-chevron-down float-end toggle-icon"></i>
            </button>
            <div class="collapsible-content">
                <div class="search-section">
                    <div class="row justify-content-center">
                        <div class="col-lg-2"></div>
                        <div class="col-lg-8">
                            <div class="form-group-modern">
                                <label class="form-label-modern">
                                    <i class="fa fa-search"></i> Search Newsletter to Delete
                                </label>
                                <input id="newsletterToDelete" class="form-control-modern" />
                            </div>
                            <div class="text-center mt-3">
                                <button type="button" class="btn btn-primary btn-modern" onclick="selectNewsletterToDelete()">
                                    <i class="fa fa-check"></i> Select
                                </button>
                            </div>
                        </div>
                        <div class="col-lg-2"></div>
                    </div>
                </div>

                <div id="delete-form-row" style="display:none;" class="mt-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-2"></div>
                        <div class="col-lg-8">
                            <div class="update-form-container">
                                <h5 class="section-title">
                                    <i class="fa fa-trash"></i> Delete Selected Newsletter
                                </h5>

                                <div class="preview-section mb-4">
                                    <p class="preview-label">Newsletter to Delete</p>
                                    <a href="#" id="toDeleteInsiderPdf" target="_blank" class="preview-link">
                                        <img id="toDeleteInsiderLogo" class="preview-image" alt="Newsletter Preview" />
                                        <div class="preview-overlay">
                                            <i class="fa fa-external-link-alt"></i>
                                        </div>
                                    </a>
                                </div>

                                <form id="delete-form" name="delete-form" method="post"
                                      action="@Url.Action("DeleteWebsiteNewsletter", "InsiderNewsletter")">
                                    <input type="hidden" id="deletedNewsletterId" name="deletedNewsletterId" />

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="deletedDescription" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-align-left"></i> Description:
                                        </label>
                                        <div class="form-input-inline">
                                            <input id="deletedDescription" name="deletedDescription" class="form-control-modern form-control-large"
                                                   type="text" maxlength="69" disabled />
                                        </div>
                                    </div>

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="deletedIssueDate" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-calendar-alt"></i> Issue Date:
                                        </label>
                                        <div class="form-input-inline">
                                            <input id="deletedIssueDate" name="deletedIssueDate" class="form-control-modern" style="width: 50%" disabled />
                                        </div>
                                    </div>

                                    <div class="form-group-modern form-group-large form-group-inline">
                                        <label for="deletedStatus" class="form-label-modern form-label-large form-label-inline">
                                            <i class="fa fa-eye"></i> Visibility:
                                        </label>
                                        <div class="form-input-inline">
                                            <div class="radio-group">
                                                <label class="radio-label">
                                                    <input type="radio" id="deletedStatusYes" name="deletedStatus" value="yes" disabled />
                                                    <span class="radio-custom"></span>
                                                    <span>Visible</span>
                                                </label>
                                                <label class="radio-label">
                                                    <input type="radio" id="deletedStatusNo" name="deletedStatus" value="no" disabled />
                                                    <span class="radio-custom"></span>
                                                    <span>Hidden</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-actions">
                                        <button type="button" class="btn btn-danger btn-modern btn-md" onclick="confirmDeleteNewsletter()">
                                            <i class="fa fa-trash"></i> Delete Newsletter
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-lg-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Log Section -->
        <div class="log-section-container mt-5">
            <div class="text-center mb-3">
                <button type="button" id="toggle-log-btn" class="btn btn-outline-secondary btn-sm" onclick="toggleLog()">
                    <i class="fa fa-eye"></i> Show Log
                </button>
            </div>
            <div id="log-section" class="log-content hidden">
                <div id="log">
                    <div class="bs-ObjectList-rows" id="log-list"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* ===== GLOBAL & LAYOUT ===== */
    #page-heading {
        display: none;
    }

    .breadcrumb {
        display: none;
    }

    .modern-wrapper {
        background: #f8f9fa;
        min-height: 100vh;
        padding-bottom: 40px;
    }

    .text-danger {
        color: #dc3545;
    }

    /* ===== PAGE HEADER ===== */
    .page-header {
        background: transparent;
        color: #333;
        padding: 20px 0 20px 15px;
        margin: 5px 0 10px;
    }

    .page-title {
        font-size: 2rem;
        font-weight: 600;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 15px;
        color: #1a73e8;
    }

    .page-subtitle {
        margin: 10px 0 0;
        color: #666;
        font-size: 1.1rem;
    }

    /* ===== ACTION CARDS & COLLAPSIBLE ===== */
    .action-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        margin-bottom: 30px;
    }

        .action-card:hover {
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        }

    .collapsible-btn {
        width: 100%;
        background: linear-gradient(135deg, #2e6da4 0%, #3d7fb8 100%);
        color: white;
        border: none;
        padding: 20px 30px;
        font-size: 15px;
        font-weight: 600;
        text-align: left;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 15px;
    }

        .collapsible-btn:hover,
        .collapsible-btn.active {
            background: linear-gradient(135deg, #245682 0%, #2e6da4 100%);
        }

        .collapsible-btn .toggle-icon {
            transition: transform 0.3s ease;
        }

        .collapsible-btn.active .toggle-icon {
            transform: rotate(180deg);
        }

    .collapsible-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s ease-in-out, padding 0.4s ease-in-out;
        padding: 0 30px;
        background: white;
    }

    .action-card .collapsible-btn.active + .collapsible-content {
        padding: 30px;
    }

    /* ===== FORMS ===== */
    .form-group-modern {
        margin-bottom: 25px;
    }

    .form-group-large {
        margin-bottom: 5px;
    }

    .form-group-inline {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .form-label-modern {
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 1.05rem;
    }

    .form-label-large {
        font-size: 1.3rem !important;
        font-weight: 700;
    }

    .form-label-inline {
        margin-bottom: 0 !important;
        min-width: 180px;
        flex-shrink: 0;
        justify-content: flex-start;
    }

    .form-input-inline {
        flex: 1;
        text-align: left;
    }

    .form-control-modern,
    #add-form .form-control,
    #add-form .form-control-large,
    #update-form .form-control,
    #update-form .form-control-large,
    #delete-form .form-control,
    #delete-form .form-control-large,
    .update-form-container .file-upload-wrapper .form-control {
        width: 100%;
        border-radius: 8px;
        border: 2px solid #ced4da !important;
        padding: 10px 15px;
        transition: all 0.3s ease;
    }

        .form-control-modern:focus,
        .update-form-container .file-upload-wrapper .form-control:focus {
            border-color: #1a73e8 !important;
            box-shadow: 0 0 0 0.2rem rgba(26, 115, 232, 0.25) !important;
        }

    .form-control-large {
        font-size: 1.2rem !important;
    }

    .file-upload-wrapper {
        display: flex;
        gap: 0.5rem;
    }

    .form-actions {
        text-align: center;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #e9ecef;
    }

    .search-section {
        padding: 20px 0;
    }

    .update-form-container {
        padding: 10px 30px;
        border-radius: 12px;
        margin-top: 20px;
        border: 1px solid #ced4da;
        box-shadow: 0 4px 20px rgba(0,0,0,0.25);
    }

    .section-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #495057;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 10px;
        padding-bottom: 15px;
        border-bottom: 2px solid #ced4da;
    }

    /* ===== BUTTONS ===== */
    .btn-modern {
        border-radius: 8px;
        padding: 12px 30px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        transition: all 0.3s ease;
        border: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

        .btn-modern:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .btn-modern i {
            margin-right: 8px;
        }

    .btn-light {
        color: #212529;
        background-color: white;
        border: 2px solid #e9ecef;
        padding: 0.625rem 1.25rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.9rem;
    }

        .btn-light:hover {
            background-color: #f8f9fa;
            border-color: #1a73e8;
            color: #1a73e8;
        }

    /* ===== PREVIEW SECTION ===== */
    .preview-section {
        text-align: center;
        margin-bottom: 2rem;
        padding: 2rem;
        background: #f8f9fa;
        border-radius: 12px;
    }

    .preview-label {
        font-weight: 600;
        color: #64748b;
        margin-bottom: 1rem;
        font-size: 0.95rem;
    }

    .preview-link {
        display: inline-block;
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .preview-link:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

    .preview-image {
        width: 255px;
        height: 320px;
        object-fit: cover;
        display: block;
        border: 4px solid white;
    }

    .preview-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(37, 99, 235, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s ease;
        color: white;
        font-size: 2.5rem;
    }

    /* ===== RADIO BUTTONS ===== */
    .radio-group {
        display: flex;
        gap: 1.5rem;
    }

    .radio-label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        font-size: 1rem;
        color: #495057;
        font-weight: 500;
    }

        .radio-label input[type="radio"] {
            display: none;
        }

    .radio-custom {
        width: 24px;
        height: 24px;
        border: 2px solid #e2e8f0;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }

        .radio-custom::after {
            content: '';
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #1a73e8;
            transform: scale(0);
            transition: transform 0.2s ease;
        }

    .radio-label input[type="radio"]:checked + .radio-custom {
        border-color: #1a73e8;
    }

        .radio-label input[type="radio"]:checked + .radio-custom::after {
            transform: scale(1);
        }

    .radio-label input[type="radio"]:disabled + .radio-custom {
        opacity: 0.5;
        cursor: not-allowed;
    }

    /* ===== LOG SECTION ===== */
    .log-section-container {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
    }

    .log-content {
        transition: all 0.4s ease-in-out;
        opacity: 1;
        max-height: 2000px;
        overflow: hidden;
    }

        .log-content.hidden {
            opacity: 0;
            max-height: 0;
            margin-top: 0 !important;
            padding: 0;
        }

    .bs-ObjectList-rows {
        display: table;
        width: 100%;
    }

    .bs-ObjectList-row {
        display: table-row;
        transition: background-color 0.2s ease;
    }

    .bs-ObjectList-row--header {
        background-color: #DCDCDC;
        color: #707070;
    }

        .bs-ObjectList-row--header .bs-ObjectList-cell {
            font-weight: 600;
            padding: 10px;
        }

    .bs-ObjectList-cell {
        display: table-cell;
        padding: 12px 10px;
        vertical-align: middle;
        border-bottom: 1px solid #e9ecef;
    }

        .bs-ObjectList-cell:first-child {
            width: 60%;
            text-align: left;
            white-space: pre-wrap;
        }

        .bs-ObjectList-cell:not(:first-child) {
            width: 20%;
            text-align: center;
        }

    /* ===== KENDO UI OVERRIDES ===== */
    .k-calendar td.k-state-selected .k-link {
        background: #1a73e8;
        border-color: #1a73e8;
    }

    .k-calendar {
        font-size: 1.1rem !important;
    }

        .k-calendar .k-content {
            font-size: 1rem !important;
        }

    /* DatePicker Styling */
    .k-datepicker .k-input,
    .k-datepicker input,
    #newIssueDate,
    #updatedIssueDate,
    #deletedIssueDate {
        font-size: 1.2rem !important;
    }

    #add-form .k-datepicker,
    #update-form .k-datepicker,
    #delete-form .k-datepicker {
        border: none !important;
        border-radius: 8px !important;
        display: block !important;
    }

        #add-form .k-datepicker .k-picker-wrap,
        #update-form .k-datepicker .k-picker-wrap,
        #delete-form .k-datepicker .k-picker-wrap {
            border: 2px solid #ced4da !important;
            border-radius: 8px !important;
        }

        #add-form .k-datepicker .k-input,
        #update-form .k-datepicker .k-input,
        #delete-form .k-datepicker .k-input {
            border: none !important;
        }

    #add-form .form-input-inline .k-datepicker,
    #update-form .form-input-inline .k-datepicker,
    #delete-form .form-input-inline .k-datepicker {
        margin-left: 0 !important;
        padding-left: 0 !important;
    }

        #add-form .form-input-inline .k-datepicker .k-picker-wrap,
        #update-form .form-input-inline .k-datepicker .k-picker-wrap,
        #delete-form .form-input-inline .k-datepicker .k-picker-wrap {
            margin-left: 0 !important;
        }

    /* DropDownList Styling */
    #newsletterToUpdate,
    #newsletterToDelete {
        border: none !important;
    }

    .search-section .k-dropdown.form-control-modern {
        border: 2px solid #ced4da !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        padding: 0 !important;
    }

        .search-section .k-dropdown.form-control-modern:hover {
            border-color: #1a73e8 !important;
        }

        .search-section .k-dropdown.form-control-modern:focus,
        .search-section .k-dropdown.form-control-modern.k-state-focused,
        .search-section .k-dropdown.form-control-modern.k-state-hover {
            border-color: #1a73e8 !important;
            box-shadow: 0 0 0 0.2rem rgba(26, 115, 232, 0.25) !important;
        }

    .search-section .k-dropdown .k-dropdown-wrap {
        border: none !important;
        box-shadow: none !important;
        padding: 8px 15px !important;
    }

        .search-section .k-dropdown .k-dropdown-wrap.k-state-default,
        .search-section .k-dropdown .k-dropdown-wrap.k-state-hover,
        .search-section .k-dropdown .k-dropdown-wrap.k-state-focused {
            border: none !important;
            background: transparent !important;
        }

    .search-section .k-dropdown .k-input {
        border: none !important;
        padding: 0 !important;
        font-size: 1.2rem;
    }

    .search-section .k-dropdown .k-select {
        border: none !important;
        border-left: 1px solid #e9ecef !important;
        background: transparent;
        padding: 0 10px;
    }

    .search-section .k-dropdown:hover .k-select {
        border-left-color: #1a73e8 !important;
    }

    /* DropDownList Popup */
    .k-list-container.k-list-container {
        border: 2px solid #ced4da !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
        margin-top: 4px !important;
    }

    .k-list .k-item {
        padding: 8px 15px !important;
        border: none !important;
        font-size: 1.05rem !important;
    }

        .k-list .k-item:hover {
            background-color: #f8f9fa !important;
            border: none !important;
        }

        .k-list .k-item.k-state-selected {
            background-color: #1a73e8 !important;
            color: white !important;
            border: none !important;
        }

    /* ===== DELETE FORM SPECIFIC ===== */
    #delete-form #deletedDescription:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        background-color: #f8f9fa;
    }

    /* ===== RESPONSIVE ===== */
    @@media (max-width: 768px) {
        .page-title {
            font-size: 1.5rem;
        }

        .page-subtitle {
            font-size: 1rem;
        }

        .collapsible-btn {
            padding: 15px 20px;
            font-size: 1rem;
        }

        .collapsible-content {
            padding: 0 20px;
        }
    }
</style>